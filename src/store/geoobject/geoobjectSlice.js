import { createSlice } from '@reduxjs/toolkit'
export const geoobjectSlice = createSlice({
    name: 'geoobject',
    initialState: {
        featureCollection: {
            type: 'FeatureCollection',
            features: [
                {
                    "type": "Feature",
                    "properties": {
                        "shape": "Polygon",
                        "name": "Unnamed Layer",
                        "category": "default"
                    },
                    "geometry": {
                        "type": "Polygon",
                        "coordinates": [
                            [
                                [-80.543682, -4.740333],
                                [-80.487213, -4.726647],
                                [-80.516052, -4.726647],
                                [-80.545056, -4.722028],
                                [-80.543682, -4.740333]
                            ]
                        ]
                        // coordinates: [
                        //     [
                        //         [
                        //             -80.50931070927119,
                        //             -4.693412417574761,
                        //             0
                        //         ],
                        //         [
                        //             -80.5093489194679,
                        //             -4.693440668921762,
                        //             0
                        //         ],
                        //         [
                        //             -80.50940343991958,
                        //             -4.69348268213497,
                        //             0
                        //         ],
                        //         [
                        //             -80.50943615303348,
                        //             -4.693506677847048,
                        //             0
                        //         ],
                        //         [
                        //             -80.50946850687004,
                        //             -4.693528683104145,
                        //             0
                        //         ],
                        //         [
                        //             -80.50952168075735,
                        //             -4.693562191775102,
                        //             0
                        //         ],
                        //         [
                        //             -80.5095742254402,
                        //             -4.693592895626644,
                        //             0
                        //         ],
                        //         [
                        //             -80.50962668040187,
                        //             -4.693622966165663,
                        //             0
                        //         ],
                        //         [
                        //             -80.50966471198565,
                        //             -4.693648774851111,
                        //             0
                        //         ],
                        //         [
                        //             -80.50972383881894,
                        //             -4.693679302352498,
                        //             0
                        //         ],
                        //         [
                        //             -80.50976241327561,
                        //             -4.693702397498035,
                        //             0
                        //         ],
                        //         [
                        //             -80.50981513799674,
                        //             -4.69373355377789,
                        //             0
                        //         ],
                        //         [
                        //             -80.50986426014754,
                        //             -4.693758917862104,
                        //             0
                        //         ],
                        //         [
                        //             -80.50990698481279,
                        //             -4.693778216412881,
                        //             0
                        //         ],
                        //         [
                        //             -80.50994799804408,
                        //             -4.693795071246889,
                        //             0
                        //         ],
                        //         [
                        //             -80.50997629738544,
                        //             -4.693812912324864,
                        //             0
                        //         ],
                        //         [
                        //             -80.51002767535257,
                        //             -4.693835835447664,
                        //             0
                        //         ],
                        //         [
                        //             -80.5100746447719,
                        //             -4.6938450050011,
                        //             0
                        //         ],
                        //         [
                        //             -80.51010618960545,
                        //             -4.693863481580967,
                        //             0
                        //         ],
                        //         [
                        //             -80.510164061308,
                        //             -4.693883695302763,
                        //             0
                        //         ],
                        //         [
                        //             -80.5102057144017,
                        //             -4.693887976101538,
                        //             0
                        //         ],
                        //         [
                        //             -80.51026314360736,
                        //             -4.693896157823358,
                        //             0
                        //         ],
                        //         [
                        //             -80.51032012224215,
                        //             -4.693903977371807,
                        //             0
                        //         ],
                        //         [
                        //             -80.51032814720261,
                        //             -4.693903530638577,
                        //             0
                        //         ],
                        //         [
                        //             -80.51037756946417,
                        //             -4.693886105524765,
                        //             0
                        //         ],
                        //         [
                        //             -80.51041091897636,
                        //             -4.693902593144434,
                        //             0
                        //         ],
                        //         [
                        //             -80.51043254634381,
                        //             -4.693920158170927,
                        //             0
                        //         ],
                        //         [
                        //             -80.51044839554947,
                        //             -4.693948755758786,
                        //             0
                        //         ],
                        //         [
                        //             -80.51048658594036,
                        //             -4.694005774523475,
                        //             0
                        //         ],
                        //         [
                        //             -80.510517289236,
                        //             -4.694067763585899,
                        //             0
                        //         ],
                        //         [
                        //             -80.51053663917355,
                        //             -4.694119070020459,
                        //             0
                        //         ],
                        //         [
                        //             -80.5105679657521,
                        //             -4.69419245795317,
                        //             0
                        //         ],
                        //         [
                        //             -80.5105836226351,
                        //             -4.694238424453657,
                        //             0
                        //         ],
                        //         [
                        //             -80.51059207078822,
                        //             -4.694277963009346,
                        //             0
                        //         ],
                        //         [
                        //             -80.51059168630877,
                        //             -4.69431242944747,
                        //             0
                        //         ],
                        //         [
                        //             -80.51058797048917,
                        //             -4.694340018319537,
                        //             0
                        //         ],
                        //         [
                        //             -80.51056865393485,
                        //             -4.694370853033798,
                        //             0
                        //         ],
                        //         [
                        //             -80.51055754967747,
                        //             -4.694391109197545,
                        //             0
                        //         ],
                        //         [
                        //             -80.51055601575295,
                        //             -4.694392736478534,
                        //             0
                        //         ],
                        //         [
                        //             -80.51052911692321,
                        //             -4.694435778527719,
                        //             0
                        //         ],
                        //         [
                        //             -80.51048625400516,
                        //             -4.694485956105831,
                        //             0
                        //         ],
                        //         [
                        //             -80.51045990322244,
                        //             -4.694518776124335,
                        //             0
                        //         ],
                        //         [
                        //             -80.51041721868457,
                        //             -4.694571758198722,
                        //             0
                        //         ],
                        //         [
                        //             -80.5103933933818,
                        //             -4.694603313478631,
                        //             0
                        //         ],
                        //         [
                        //             -80.510357659521,
                        //             -4.694644721021126,
                        //             0
                        //         ],
                        //         [
                        //             -80.51032283637423,
                        //             -4.694673011945749,
                        //             0
                        //         ],
                        //         [
                        //             -80.51029179732588,
                        //             -4.694705376373407,
                        //             0
                        //         ],
                        //         [
                        //             -80.51026337305063,
                        //             -4.69473774261991,
                        //             0
                        //         ],
                        //         [
                        //             -80.51022340681618,
                        //             -4.694771367321174,
                        //             0
                        //         ],
                        //         [
                        //             -80.51017892871353,
                        //             -4.694810235777387,
                        //             0
                        //         ],
                        //         [
                        //             -80.51014238384784,
                        //             -4.694850919031093,
                        //             0
                        //         ],
                        //         [
                        //             -80.51011052654101,
                        //             -4.694893052967872,
                        //             0
                        //         ],
                        //         [
                        //             -80.51007830325071,
                        //             -4.694942876069597,
                        //             0
                        //         ],
                        //         [
                        //             -80.51005998078418,
                        //             -4.69497036429755,
                        //             0
                        //         ],
                        //         [
                        //             -80.51002687599782,
                        //             -4.694991057443307,
                        //             0
                        //         ],
                        //         [
                        //             -80.5100077586363,
                        //             -4.694994572212843,
                        //             0
                        //         ],
                        //         [
                        //             -80.50998512654118,
                        //             -4.694995642010953,
                        //             0
                        //         ],
                        //         [
                        //             -80.50996718557833,
                        //             -4.694993006061594,
                        //             0
                        //         ],
                        //         [
                        //             -80.50993734606672,
                        //             -4.694985748168468,
                        //             0
                        //         ],
                        //         [
                        //             -80.50991724522153,
                        //             -4.694977230567083,
                        //             0
                        //         ],
                        //         [
                        //             -80.50985820173855,
                        //             -4.694956382753668,
                        //             0
                        //         ],
                        //         [
                        //             -80.50981358285888,
                        //             -4.694938077974675,
                        //             0
                        //         ],
                        //         [
                        //             -80.50971944825221,
                        //             -4.694811634460756,
                        //             0
                        //         ],
                        //         [
                        //             -80.50965505054126,
                        //             -4.694710451062896,
                        //             0
                        //         ],
                        //         [
                        //             -80.50961025561432,
                        //             -4.69468599461317,
                        //             0
                        //         ],
                        //         [
                        //             -80.50960947865434,
                        //             -4.694636148528611,
                        //             0
                        //         ],
                        //         [
                        //             -80.50960417767253,
                        //             -4.694609096162603,
                        //             0
                        //         ],
                        //         [
                        //             -80.50960521096005,
                        //             -4.694549209860446,
                        //             0
                        //         ],
                        //         [
                        //             -80.50960656512146,
                        //             -4.694546768282426,
                        //             0
                        //         ],
                        //         [
                        //             -80.50959064131463,
                        //             -4.6944957356086,
                        //             0
                        //         ],
                        //         [
                        //             -80.50956172277401,
                        //             -4.694460615499798,
                        //             0
                        //         ],
                        //         [
                        //             -80.50953378733749,
                        //             -4.694438070540878,
                        //             0
                        //         ],
                        //         [
                        //             -80.50950053525983,
                        //             -4.694411089148578,
                        //             0
                        //         ],
                        //         [
                        //             -80.50947106752993,
                        //             -4.694387819408863,
                        //             0
                        //         ],
                        //         [
                        //             -80.50944042841391,
                        //             -4.694363463285844,
                        //             0
                        //         ],
                        //         [
                        //             -80.50939798425263,
                        //             -4.69432969069556,
                        //             0
                        //         ],
                        //         [
                        //             -80.50935283615988,
                        //             -4.694294468796663,
                        //             0
                        //         ],
                        //         [
                        //             -80.50931570720599,
                        //             -4.694267213301462,
                        //             0
                        //         ],
                        //         [
                        //             -80.50928416049928,
                        //             -4.694251450598339,
                        //             0
                        //         ],
                        //         [
                        //             -80.50924747735802,
                        //             -4.69423143251305,
                        //             0
                        //         ],
                        //         [
                        //             -80.50921511647718,
                        //             -4.694219559181471,
                        //             0
                        //         ],
                        //         [
                        //             -80.50918167098885,
                        //             -4.694211484570332,
                        //             0
                        //         ],
                        //         [
                        //             -80.50913795745971,
                        //             -4.694187933487248,
                        //             0
                        //         ],
                        //         [
                        //             -80.5091050593583,
                        //             -4.694170631949626,
                        //             0
                        //         ],
                        //         [
                        //             -80.50908216338279,
                        //             -4.694162202840655,
                        //             0
                        //         ],
                        //         [
                        //             -80.50904457026519,
                        //             -4.694154215792652,
                        //             0
                        //         ],
                        //         [
                        //             -80.50900418223439,
                        //             -4.694145955400622,
                        //             0
                        //         ],
                        //         [
                        //             -80.50897307689229,
                        //             -4.69414385302241,
                        //             0
                        //         ],
                        //         [
                        //             -80.50894890864105,
                        //             -4.694149806761112,
                        //             0
                        //         ],
                        //         [
                        //             -80.5087575944104,
                        //             -4.69373806303156,
                        //             0
                        //         ],
                        //         [
                        //             -80.50831061057532,
                        //             -4.69288368235913,
                        //             0
                        //         ],
                        //         [
                        //             -80.50830259649172,
                        //             -4.692868478846142,
                        //             0
                        //         ],
                        //         [
                        //             -80.50831406012068,
                        //             -4.692850122711949,
                        //             0
                        //         ],
                        //         [
                        //             -80.50832101113257,
                        //             -4.692838095888012,
                        //             0
                        //         ],
                        //         [
                        //             -80.50834232384241,
                        //             -4.692789260345503,
                        //             0
                        //         ],
                        //         [
                        //             -80.50836336762552,
                        //             -4.692738163019872,
                        //             0
                        //         ],
                        //         [
                        //             -80.50835771947837,
                        //             -4.692691751160476,
                        //             0
                        //         ],
                        //         [
                        //             -80.5083451135413,
                        //             -4.69266713620788,
                        //             0
                        //         ],
                        //         [
                        //             -80.50831998894554,
                        //             -4.692622067696497,
                        //             0
                        //         ],
                        //         [
                        //             -80.50830630725474,
                        //             -4.692588496078751,
                        //             0
                        //         ],
                        //         [
                        //             -80.50831129084767,
                        //             -4.692553128227703,
                        //             0
                        //         ],
                        //         [
                        //             -80.50833493947033,
                        //             -4.69251632599756,
                        //             0
                        //         ],
                        //         [
                        //             -80.50835586752568,
                        //             -4.692502047344,
                        //             0
                        //         ],
                        //         [
                        //             -80.50838470964086,
                        //             -4.692517174943614,
                        //             0
                        //         ],
                        //         [
                        //             -80.50842436181519,
                        //             -4.692546241514264,
                        //             0
                        //         ],
                        //         [
                        //             -80.5084607651875,
                        //             -4.692579467147048,
                        //             0
                        //         ],
                        //         [
                        //             -80.50849248108204,
                        //             -4.692611151620094,
                        //             0
                        //         ],
                        //         [
                        //             -80.5085208602692,
                        //             -4.692643738399229,
                        //             0
                        //         ],
                        //         [
                        //             -80.50853644295562,
                        //             -4.692666455689139,
                        //             0
                        //         ],
                        //         [
                        //             -80.50856266140215,
                        //             -4.692694427305462,
                        //             0
                        //         ],
                        //         [
                        //             -80.50859410185535,
                        //             -4.692733258220406,
                        //             0
                        //         ],
                        //         [
                        //             -80.50862095346564,
                        //             -4.692758335436489,
                        //             0
                        //         ],
                        //         [
                        //             -80.50862329610871,
                        //             -4.692760689130468,
                        //             0
                        //         ],
                        //         [
                        //             -80.5086523996352,
                        //             -4.692788934150112,
                        //             0
                        //         ],
                        //         [
                        //             -80.5086835789536,
                        //             -4.692814285777449,
                        //             0
                        //         ],
                        //         [
                        //             -80.50872160926455,
                        //             -4.692841813317436,
                        //             0
                        //         ],
                        //         [
                        //             -80.50877396693933,
                        //             -4.692882015786191,
                        //             0
                        //         ],
                        //         [
                        //             -80.50880920203487,
                        //             -4.692909722298255,
                        //             0
                        //         ],
                        //         [
                        //             -80.50885416962333,
                        //             -4.69294503455931,
                        //             0
                        //         ],
                        //         [
                        //             -80.5088881331401,
                        //             -4.692986128819086,
                        //             0
                        //         ],
                        //         [
                        //             -80.50892470772934,
                        //             -4.693032562262635,
                        //             0
                        //         ],
                        //         [
                        //             -80.50897336166375,
                        //             -4.693082894076833,
                        //             0
                        //         ],
                        //         [
                        //             -80.50902516935469,
                        //             -4.693136122929838,
                        //             0
                        //         ],
                        //         [
                        //             -80.50906895862309,
                        //             -4.69318039027113,
                        //             0
                        //         ],
                        //         [
                        //             -80.50909355684553,
                        //             -4.693204470798462,
                        //             0
                        //         ],
                        //         [
                        //             -80.50912473105765,
                        //             -4.693237240435546,
                        //             0
                        //         ],
                        //         [
                        //             -80.50914977139196,
                        //             -4.693273895734782,
                        //             0
                        //         ],
                        //         [
                        //             -80.50918852080596,
                        //             -4.693304680451178,
                        //             0
                        //         ],
                        //         [
                        //             -80.50919059314735,
                        //             -4.69330676256368,
                        //             0
                        //         ],
                        //         [
                        //             -80.50921942666476,
                        //             -4.693334374129215,
                        //             0
                        //         ],
                        //         [
                        //             -80.50926799486417,
                        //             -4.693378373402539,
                        //             0
                        //         ],
                        //         [
                        //             -80.50931070927119,
                        //             -4.693412417574761,
                        //             0
                        //         ],
                        //         [
                        //             -80.50931070927119,
                        //             -4.693412417574761,
                        //             0
                        //         ]
                        //     ]
                        // ]
                    },
                },
                {
                    "type": "Feature",
                    "properties": {
                        "shape": "Circle",
                        "radius": 257.9548913768531,
                    },
                    "geometry": {
                        "type": "Point",
                        "coordinates": [-80.513862, -4.714629]
                    }
                },
                {
                    "type": "Feature",
                    "properties": {
                        "shape": "Marker",
                        "name": "Unnamed Layer",
                        "category": "default"
                    },
                    "geometry": {
                        "type": "Point",
                        "coordinates": [-80.515878, -4.711934]
                    }
                },
            ]
        },
        isSaving: false,
        isSavingNew: false,
    },
    reducers: {
        addNewGeometry: (state, { payload }) => {
            state.featureCollection.features = [...state.featureCollection.features, payload]
        },
        addNewGeometrys: (state, { payload }) => {
            // const features = [
            //     ...payload,
            //     ...state.featureCollection.features,
            // ]

            // state.featureCollection.features = [...features.filter((obj, index) => index === features.findIndex(o => obj.id === o.id))]

            state.featureCollection.features = [
                ...state.featureCollection.features,
                ...payload,
            ]
        },
        setFeatureCollection: (state, { payload }) => {
            state.featureCollection = payload
        },
        setGeometryByIndex: (state, { payload }) => {
            state.featureCollection.features = state.featureCollection.features.map((f, index) => {
                if (payload.index === index) {
                    return {
                        ...f,
                        id: payload.id
                    }
                }

                return f
            })
        },
        setGeometryById: (state, { payload }) => {
            state.featureCollection = state.featureCollection.features.map(f => {
                if (payload.includes(f.id.toString())) {
                    return {
                        ...f,
                        id: payload
                    }
                }

                return f
            })
        },
        deleteGeometryById: (state, { payload }) => {
            state.featureCollection = state.featureCollection.features.filter(f => !payload.includes(f.id.toString()))
        },
        editFeatureCollection: (state, { payload }) => {
            state.featureCollection = payload
        },
        clearFeatureCollection: (state) => {
            state.featureCollection = {
                type: 'FeatureCollection',
                features: []
            }
        },
        setSavingGeometry: (state, { payload }) => {
            state.isSaving = payload
        },
        setSavingNewGeometry: (state, { payload }) => {
            state.isSavingNew = payload
        },
    }
});

export const {
    addNewGeometry,
    addNewGeometrys,
    clearFeatureCollection,
    deleteGeometryById,
    editFeatureCollection,
    setGeometryById,
    setGeometryByIndex,
    setSavingGeometry,
    setSavingNewGeometry,
    setFeatureCollection,
} = geoobjectSlice.actions